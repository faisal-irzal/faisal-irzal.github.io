---
layout: post
title: Market-based Energy Production Optimization
image: "/posts/PowerStation.jpg"
tags: [Python, H2O AutoML, Energy Demand, Production Optimization]
---

Several machine learning (ML) models will be demonstrated in this post to predict electricity production from a power plant based on environmental and control features. Exploratory Data Analysis will be conducted to find correlations of each features to the target variable. Results of the trained models will be compared and the best model will be further used to recommend some exemplary energy market actions.

---

### Introduction to Business Problem 

To ensure a steady supply of electricity to consumers, energy suppliers owning a power plant should produce and supply the right amount of electricity on the grid at every moment to instantaneously meet and balance electricity demand. To this end, it is important for them to know in advance how much power output they can produce by taking into account certain parameters, and how much the current market price in such way they can maximize the profit of selling the produced electric power.

This Notebook will focus on a combined cycle power plant, which consists of gas turbines, steam turbines, and heat recovery steam generators, see figure below. In this type of plant, the electric power is generated by gas and steam turbines combined in one cycle. Then, it is transferred from one turbine to another. While the vacuum is collected from and has an effect on the steam turbine, the ambient variables (i.e. temperature, pressure and humidity) affect the gas turbine performance. This case study aims to model the energy generated as a function of the exhaust vacuum and the ambient variables and use that model to predict the output performance of the plant. This output will be used to estimate cost and profit for certain actions made by energy supplier.

<td> 
  <p align="center"> <img src="/img/posts/CCNG-fullsize.jpg"> 
  </p> 
</td>

---

### Data Acquisition

The datasets used for this case study are:
- Combined cycle power plant data from [UCI Machine Learning Repository](http://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant)

  This dataset contains 9568 data points collected from a combined cycle powerplant over 6 years, where the power plant was set to work with full load. Hour data were collected for Average Ambient Temperature (**T[degC]**), Exhaust Vacuum (**V[cm Hg]**), Ambient Pressure (**AP[mbar]**), Relative Humidity (**RH[%]**), and Net Electrical Power Output (**EP[MW]**). For the purpose of the study, the powerplant data has been modified by adding a mockup datetime variable. 

- Pool price (market) forecast data from [AESO](http://ets.aeso.ca/) 

Pool price forecast dataset from AESO containing 168 data points will be used for the time market analysis, which is from 2021-07-06 to 2021-07-12. The data contains forecast and actual value of the pool price ($/MWH) and the Alberta Internal Load (AIL), which is the demand of energy (MW) at the hour. The forecast of pool price is made two hours prior to the listed time. This dataset will later be used to estimate cost/profit impacted by selected action by energy supplier.

---

### Data Exploration & Analysis

To conduct the initial data exploration, pandas-profiling library is used for generating basic insights. The library works with pandas dataframe and can provide quick and basic exploratory data analysis. Below graph shows **Pearson's Correlation** between the features in the Combined Cycle Power Plant data as well as Market Forecast Data. 

<table>
  <tr>
    <td> <p align="center">  Power Plant Data </p> </td>
    <td> <p align="center">  Market Forecast Data </p> </td>
  </tr>
  <tr>
    <td> <p align="center"> <img src="/img/posts/Pearsons_cor.jpg"> </p> </td> 
    <td> <p align="center"> <img src="/img/posts/AESO_Pearsons.jpg"> </p> </td> 
  </tr>
</table>

Pearson's correlation measures the linear correlation between two features. Its value lies between -1 and +1, where -1 indicates total negative linear correlation while +1 indicates total positive linear correlation. 

From the graph on the left side above we observes that the average ambient temperature **(T[degC])** and the exhaust vacuum **(V[cm Hg])** have negative correlation with the target variable, i.e. Electrical Power Output (**EP[MW]**). On the other hand, Ambient Pressure (**AP[mbar]**) and Relative Humidity (**RH[%]**) have insignificant positive correlation. The presented data is in aligned with reference made in some literatures [1] stating that power output will be reduced by a percentage between 5 to 10 percent for every 10 degC increase in ambient air temperature. 

The graph on the right side gives us insights that indeed the actual market price has strong correlation with the forecasted pool price and it corresponds with the forecasted & actual demand of energy (AIL) at the hour.

---

### ML Model Development

For demonstration, H2O AutoML will be utilized to help us fast track the implementation and evaluation of Machine Learning algorithms. AutoML is a function in H2O.ai cloud platform that automates the process of building a large number of models, with the goal of finding the "best" model without any prior knowledge. 

To begin, the H2O Python model is importend and H2OAutoML class is initialized in a local H2O cluster. Power plant data is then imported to H2O dataframe to conduct the analysis, by taking into account features and target (**EP[MW]**) variable and 80 to 20 ratio of training and test data.

Next, the AutoML Leaderboard is observed. Since a leaderboard frame was not specified in the H2OAutoML.train() method for scoring and ranking the models, the AutoML leaderboard uses the cross validation metrics to rank the models.

A default performance metric for each machine learning task (binary classification, multiclass classification, regression) is specified internally and the leaderboard will be sorted by that metric. In the case of regression, the default ranking metric is mean residual deviance. In the future, the user will be able to specify any of the H2O metrics so that different metrics can be used to generate rankings on the leaderboard. The top models resulting from the training by H2O AutoML can be found as per below table.

<td> <p align="center"> <img src="/img/posts/MLtopmodels.jpg"> </p> </td> 

The top ranked model may not always be the best model for the selection. Often model selection needs to take into account the usability, resource consumption, run time, etc. Depending on the problem, it may need to use different error metrics as the representation of model's accuracy as well.
Since this notebook is for demonstration of the general process, the top ranked model is chosen, .i.e. XGBoost. 



---

### Results & Conclusion

---

### Reference

[1] Kakaras, E. (2006) , Inlet Air Cooling Methods for Gas Turbine Based Power Plant, ASME vol.128, pp. 312-317.

